<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ciclos</title>
    <style>
        label{
            margin: 0 5px 0 5px;
        }
        fieldset{
            margin: 5px;
            width: 40vw; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            flex-wrap: wrap;    
        }
        p{
            width: 80%;
        }
    </style>
</head>
<body>
    <section style="width: 100%; display: flex; align-items: center; justify-content: space-around; background-color: rgb(90, 90, 90);">
        <h2 style="width: 60%; color: white;">Lista de Ciclos</h2>
        
        <button onclick="crearCiclo()">crear</button>
    </section>
    <section id="sec_ciclos" style="padding: 10px; border: 1px solid black; text-align: center; display: flex; align-items: center; justify-content: center; flex-direction: column;">
        <article id="art_ciclos">
        
        </article>
    </section>

    <script src="crearCiclos.js"></script>
    <script>
        // Función para obtener los datos de los ciclos
        async function cargarCiclos() {
            try {
                // Obtiene los datos de la tabla ciclos en forma json
                const response = await fetch('http://localhost:3000/ciclos');
                if (!response.ok) {
                    throw new Error(`Error al obtener los ciclos: ${response.statusText}`);
                }
                const ciclos = await response.json();                
                mostrarCiclos(ciclos);
            } catch (error) {
                console.error(error);
            }
        }

        // Función para cargar los ciclos en la seccion
        function mostrarCiclos(ciclos) {
            // Busca el elemento html al que le vamos a agregar los datos
            const article = document.getElementById('sec_ciclos').querySelector('article');
            // Limpiar la el article antes de agregar nuevos datos
            article.innerHTML = '';
            ciclos.forEach(ciclo => {
                const fila = document.createElement('fieldset');   // crea en el html esta etiqueta = <fieldset> </fieldset>
                fila.id = ciclo.id_ciclos;
                fila.innerHTML = 
                `
                    <legend id="id_ciclos" style="align-self: self-start;">${ciclo.id_ciclos} - ${ciclo.nombre}</legend>

                    <p>
                        <label for="name"><span>Id: </span>
                            <strong><span aria-label="required">*</span></strong>
                        </label>
                        <input type="text" id="idCiclo" name="ciclo-id" value="${ciclo.id_ciclos}" required></input>
                    </p>
                    
                    <p>
                        <label for="name"><span>Nombre: </span>
                            <strong><span aria-label="required">*</span></strong>
                        </label>
                        <input type="text" id="nombre" name="ciclo-nombre" value="${ciclo.nombre}" required></input>
                    </p>
                    
                    <p>
                        <label for="pwd"><span>Duracion: </span>
                            <strong><span aria-label="required">*</span></strong>
                        </label>
                        <input type="text" id="duracion" name="ciclo-duracion" value="${ciclo.duracion}" required></input>
                    </p>

                    <p>
                        <label for="mail"><span>Descripcion: </span>
                            <strong><span aria-label="required">*</span></strong>
                        </label>
                        <textarea type="text" id="descripcion" name="ciclo-descripcion" required>${ciclo.descripcion}</textarea>
                    </p>

                    <section style="width: 100%;">
                        <button>guardar</button>
                        <button>eliminar</button>
                    </section>
                `
                ;
                article.appendChild(fila);
            });
        }

        // Cargar los ciclos al cargar la página
        cargarCiclos();
    </script>
</body>
</html>